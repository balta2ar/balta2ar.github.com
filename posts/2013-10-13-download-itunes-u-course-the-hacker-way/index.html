<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Download iTunes U Course - The Hacker Way | Mostly Technical</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css></head><body><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/index.xml>Subscribe</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>Download iTunes U Course - The Hacker Way</span></h1><h2 class=date>2013/10/13</h2><p class=terms>Tags: <a href=/tags/xml>xml</a> <a href=/tags/xmlstartlet>xmlstartlet</a> <a href=/tags/apple>Apple</a> <a href=/tags/itunesu>iTunesU</a> <a href=/tags/bash>bash</a></p></div><main><p>Today, kids, we are going to download iTunes U course almost exclusively from
the command line.</p><h2 id=why>Why</h2><p>The easiest way to do that is to use iTunes to download all that for you.
Unfortunately, while I have iPod/iPad in my home ecosystem, I don&rsquo;t have any
Mac computers. Thus, I&rsquo;m running iTunes in a virtual machine on Windows.
Imagine my user experience from such combination. Pure pain and suffering.</p><p>There wouldn&rsquo;t be this post if it was all smooth. For unknown reasons my iTunes
doesn&rsquo;t save downloaded video files. I can see it&rsquo;s downloading them, I can
see the temp file growing, but when it&rsquo;s done, puff, I can&rsquo;t find the file
anywhere. Luckily, there is a solution. It is a pity but you still need iTunes
for a couple of steps.</p><h2 id=how>How</h2><p>OK, let&rsquo;s do it. Say, you found an interesting course on iTunes U:</p><p><img src=./ml.png alt></p><h3 id=step-1-subscribe-to-the-course-in-itunes>Step 1. Subscribe to the course in iTunes</h3><h3 id=step-2-copy-course-url>Step 2. Copy course url</h3><p>Click on any item in the course materials list and
select &ldquo;Copy iTunes U URL&rdquo;.</p><p><img src=./copy-url.png alt></p><p>NB: There is <a href=https://itunesu.itunes.apple.com/coursemanager/>iTunes U Course Manager</a>
web page and I presume you might get the feed URL there (though I really doubt
you can). However, my country isn&rsquo;t enjoying Apple&rsquo;s favour.</p><p><img src=./bad-country.png alt></p><h3 id=step-3-download-the-feed>Step 3. Download the feed</h3><pre tabindex=0><code>wget -O list.xml https://p1-u.itunes.apple.com/WebObjects/LZStudent.woa/ra/feed/CODBABB3ZC
</code></pre><h3 id=step-4-extract-links-and-titles>Step 4. Extract links and titles</h3><p>The feed contains <code>feed/entry</code> items in the format as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;feed</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.w3.org/2005/Atom&#34;</span> <span style=color:#a6e22e>xmlns:itms=</span><span style=color:#e6db74>&#34;http://www.itunes.com/dtds/itunesu-1.0.dtd&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;title</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text&#34;</span><span style=color:#f92672>&gt;</span>Machine Learning<span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;subtitle</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text&#34;</span><span style=color:#f92672>&gt;</span>&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;strong&amp;gt;A real Caltech course...<span style=color:#f92672>&lt;/subtitle&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;updated&gt;</span>2013-06-12T00:19:12PDT<span style=color:#f92672>&lt;/updated&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;link</span> <span style=color:#a6e22e>rel=</span><span style=color:#e6db74>&#34;alternate&#34;</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text/html&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>href=</span><span style=color:#e6db74>&#34;https://p1-u.itunes.apple.com/WebObjects/LZStudent.woa/ra/courses/CODBABB3ZC&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;id&gt;</span>1/CODBABB3ZC<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;itms:courseid&gt;</span>CODBABB3ZC<span style=color:#f92672>&lt;/itms:courseid&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;itms:auditUrl&gt;</span>https://itunesu.itunes.apple.com/audit/CODBABB3ZC<span style=color:#f92672>&lt;/itms:auditUrl&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;entry&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;author&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;name&gt;</span>Dr. Yaser Abu-Mostafa<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/author&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;title</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;html&#34;</span><span style=color:#f92672>&gt;</span><span style=color:#75715e>&lt;![CDATA[AC___Lecture 01 slides]]&gt;</span><span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;id&gt;</span>1/CODBABB3ZC/MAES7ECEVA<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;updated&gt;</span>2013-06-11T23:25:24PDT<span style=color:#f92672>&lt;/updated&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;published&gt;</span>2012-06-14T15:07:36PDT<span style=color:#f92672>&lt;/published&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;summary</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;html&#34;</span><span style=color:#f92672>&gt;</span><span style=color:#75715e>&lt;![CDATA[AC___Lecture 01 slides]]&gt;</span><span style=color:#f92672>&lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;link</span> <span style=color:#a6e22e>rel=</span><span style=color:#e6db74>&#34;enclosure&#34;</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;application/pdf&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>href=</span><span style=color:#e6db74>&#34;http://a1372.phobos.apple.com/us/r30/CobaltPublic/v4/35/56/6a/35566a02-1e0a-3db8-17e2-69be6445ba9b/208-5815754981465838988-ACsld01.pdf&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>length=</span><span style=color:#e6db74>&#34;300673&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/entry&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>It is very convenient to use <a href=http://xmlstar.sourceforge.net/doc/UG/xmlstarlet-ug.html>xmlstartlet</a>
to extract titles and links from the feed. Note, however, that xmlstartlet is
very picky to namespace (thanks to <a href=http://stackoverflow.com/questions/9025492/xmlstarlet-does-not-select-anything>this</a>
answer). Extraction command will look as follows:</p><pre tabindex=0><code>xml sel -N x=&#34;http://www.w3.org/2005/Atom&#34; -t -m //x:entry -v x:title -o &#34;|&#34; -v x:link/@href -n list.xml &gt; fmt.txt
</code></pre><h3 id=step-5-download-the-course>Step 5. Download the course</h3><p>Now all that is left is to read titles and links and
download them. I prefer to use <a href=http://aria2.sourceforge.net/>aria2c</a></p><pre tabindex=0><code>IFS=&#39;|&#39; &amp;&amp; while read a b; do n=$a.${b##*.}; aria2c --allow-overwrite=false --auto-file-renaming=false -o $n $b; done &lt; fmt.txt
</code></pre><p><code>${b##*.}</code> is a command to get filename extension (see <a href=http://stackoverflow.com/questions/965053/extract-filename-and-extension-in-bash>this</a>
and <a href=http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html#Shell-Parameter-Expansion>this</a>)</p><h2 id=references>References</h2><ol><li><a href=http://alistairisrael.wordpress.com/2007/09/26/querying-an-xml-document-using-xmlstarlet/>Querying an XML document using XMLStarlet</a></li><li><a href=http://xmlstar.sourceforge.net/doc/UG/xmlstarlet-ug.html>XmlStarlet Command Line XML Toolkit User&rsquo;s Guide</a></li><li><a href=http://www.freesoftwaremagazine.com/articles/xml_starlet>XMLStarlet: a Unix toolkit for XML</a></li></ol></main><footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script>
<script>hljs.configure({languages:[]}),hljs.highlightAll()</script><hr>Â© <a href=https://balta2ar.github.io>Yuri Bochkarev</a> 2009 &ndash; 2023 | <a href=https://github.com/balta2ar>Github</a>
| <a href=https://github.com/balta2ar/balta2ar.github.com/edit/main/content/posts/2013-10-13-download-itunes-u-course-the-hacker-way/index.md>Edit this page</a></footer></body></html>